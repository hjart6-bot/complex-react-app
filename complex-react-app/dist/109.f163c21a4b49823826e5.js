(self.webpackChunkcomplex_react_app=self.webpackChunkcomplex_react_app||[]).push([[109,210],{8109:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var l=a(7294),s=a(195),o=a(1387),n=a(5977),r=a(3727),u=a(9669),c=a.n(u),i=a(7062),d=a(7564),m=a(3983),v=a(2210);const p=(0,n.EN)((function(e){const t=(0,l.useContext)(d.Z),a=(0,l.useContext)(m.Z),u={title:{value:"",hasErrors:!1,message:""},body:{value:"",hasErrors:!1,message:""},isFetching:!0,isSaving:!1,id:(0,n.UO)().id,sendCount:0,notFound:!1},[p,h]=(0,s.C)((function(e,t){switch(t.type){case"fetchComplete":return e.title.value=t.value.title,e.body.value=t.value.body,void(e.isFetching=!1);case"titleChange":return e.title.hasErrors=!1,void(e.title.value=t.value);case"bodyChange":return e.body.hasErrors=!1,void(e.body.value=t.value);case"submitRequest":return void(e.title.hasErrors||e.body.hasErrors||e.sendCount++);case"saveRequestStarted":return void(e.isSaving=!0);case"saveRequestFinished":return void(e.isSaving=!1);case"titleRules":return void(t.value.trim()||(e.title.hasErrors=!0,e.title.message="You must provide a title."));case"bodyRules":return void(t.value.trim()||(e.body.hasErrors=!0,e.body.message="You must provide body content."));case"notFound":return void(e.notFound=!0)}}),u);return(0,l.useEffect)((()=>{const l=c().CancelToken.source();return async function(){try{const s=await c().get(`/post/${p.id}`,{cancelToken:l.token});s.data?(h({type:"fetchComplete",value:s.data}),t.user.username!=s.data.author.username&&(a({type:"flashMessage",value:"You do not have permission to edit that post."}),e.history.push("/"))):h({type:"notFound"})}catch(e){console.log("There was a problem or the request was cancelled.")}}(),()=>{l.cancel()}}),[]),(0,l.useEffect)((()=>{if(p.sendCount){h({type:"saveRequestStarted"});const e=c().CancelToken.source();return async function(){try{await c().post(`/post/${p.id}/edit`,{title:p.title.value,body:p.body.value,token:t.user.token},{cancelToken:e.token}),h({type:"saveRequestFinished"}),a({type:"flashMessage",value:"Post was updated."})}catch(e){console.log("There was a problem or the request was cancelled.")}}(),()=>{e.cancel()}}}),[p.sendCount]),p.notFound?l.createElement(v.default,null):p.isFetching?l.createElement(o.Z,{title:"loading..."},l.createElement(i.Z,null)):l.createElement(o.Z,{title:"Edit Post"},l.createElement(r.rU,{className:"small font-weight-bold",to:`/post/${p.id}`},"Â« Back to post permalink"),l.createElement("form",{className:"mt-3",onSubmit:function(e){e.preventDefault(),h({type:"titleRules",value:p.title.value}),h({type:"bodyRules",value:p.body.value}),h({type:"submitRequest"})}},l.createElement("div",{className:"form-group"},l.createElement("label",{htmlFor:"post-title",className:"text-muted mb-1"},l.createElement("small",null,"Title")),l.createElement("input",{onBlur:e=>h({type:"titleRules",value:e.target.value}),onChange:e=>h({type:"titleChange",value:e.target.value}),value:p.title.value,autoFocus:!0,name:"title",id:"post-title",className:"form-control form-control-lg form-control-title",type:"text",placeholder:"",autoComplete:"off"}),p.title.hasErrors&&l.createElement("div",{className:"alert alert-danger small liveValidateMessage"},p.title.message)),l.createElement("div",{className:"form-group"},l.createElement("label",{htmlFor:"post-body",className:"text-muted mb-1 d-block"},l.createElement("small",null,"Body Content")),l.createElement("textarea",{onBlur:e=>h({type:"bodyRules",value:e.target.value}),onChange:e=>h({type:"bodyChange",value:e.target.value}),name:"body",id:"post-body",className:"body-content tall-textarea form-control",type:"text",value:p.body.value}),p.body.hasErrors&&l.createElement("div",{className:"alert alert-danger small liveValidateMessage"},p.body.message)),l.createElement("button",{className:"btn btn-primary",disabled:p.isSaving},p.isSaving?"Saving...":"Save Updates")))}))},2210:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var l=a(7294),s=a(1387),o=a(3727);const n=function(){return l.createElement(s.Z,{title:"Not Found"},l.createElement("div",{className:"text-center"},l.createElement("h2",null,"Whoops, we cannot find that page."),l.createElement("p",{className:"lead text-muted"},"You can always visit the ",l.createElement(o.rU,{to:"/"},"homepage")," to get a fresh start.")))}}}]);